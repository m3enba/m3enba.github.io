<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Krestiki Noliki 9x9</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Outfit', sans-serif;
            background-color: #0f172a; /* Slate 900 */
            color: white;
            overflow: hidden;
            touch-action: manipulation;
        }

        .board-container {
            width: 100%;
            max-width: 500px; /* Constrain max size for better playability */
            aspect-ratio: 1;
            padding: 0.5rem;
        }

        .cell {
            background: rgba(30, 41, 59, 0.7); /* Slate 800 */
            border-radius: 4px; /* Smaller radius for smaller cells */
            transition: all 0.15s ease;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem; /* Adjusted for 9x9 */
        }

        .cell:hover:not(.taken) {
            background: rgba(51, 65, 85, 0.9);
        }

        .cell.taken {
            cursor: default;
        }

        /* SVG Icon Styles */
        .icon-x { color: #22d3ee; width: 70%; height: 70%; }
        .icon-o { color: #fb7185; width: 70%; height: 70%; }

        .winning-cell {
            background-color: rgba(16, 185, 129, 0.2) !important;
            border: 1px solid #10b981;
            box-shadow: 0 0 10px rgba(16, 185, 129, 0.3);
        }
        
        /* Grid Lines visual effect (optional, using gap instead) */
        .game-grid {
            display: grid;
            grid-template-columns: repeat(9, 1fr);
            grid-template-rows: repeat(9, 1fr);
            gap: 2px;
            background-color: #334155; /* Slate 700 for grid lines */
            border: 2px solid #334155;
            border-radius: 0.5rem;
            overflow: hidden;
        }

        /* Animation */
        .pop-in {
            animation: pop 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        @keyframes pop {
            from { transform: scale(0); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
    </style>
</head>
<body class="h-screen w-screen flex flex-col items-center justify-center p-2 select-none">

    <!-- Header -->
    <div class="text-center mb-4">
        <h1 class="text-3xl md:text-4xl font-bold bg-gradient-to-r from-cyan-400 to-rose-400 bg-clip-text text-transparent">
            Krestiki Noliki 9x9
        </h1>
        <div id="status-display" class="text-slate-400 text-sm font-medium mt-1">
            Goal: Create a 2x2 square to win
        </div>
    </div>

    <!-- Game Board -->
    <div class="board-container">
        <div id="game-grid" class="game-grid h-full w-full bg-slate-800">
            <!-- Cells generated by JS -->
        </div>
    </div>

    <!-- Controls -->
    <div class="mt-6">
        <button id="reset-btn" class="px-6 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-full font-bold transition-colors shadow-lg flex items-center gap-2 text-sm">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 12"/><path d="M3 3v9h9"/></svg>
            Restart Game
        </button>
    </div>

    <script>
        const GRID_SIZE = 9;
        const TOTAL_CELLS = GRID_SIZE * GRID_SIZE;
        const PLAYERS = { X: 'X', O: 'O' };

        let currentPlayer = PLAYERS.X;
        let gameActive = true;
        let gameState = Array(TOTAL_CELLS).fill("");

        const gridElement = document.getElementById('game-grid');
        const statusDisplay = document.getElementById('status-display');
        const resetBtn = document.getElementById('reset-btn');

        // Icons
        const SVG_X = `<svg class="icon-x pop-in" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>`;
        const SVG_O = `<svg class="icon-o pop-in" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle></svg>`;

        // Initialize Board
        function createBoard() {
            gridElement.innerHTML = '';
            gameState = Array(TOTAL_CELLS).fill("");
            gameActive = true;
            currentPlayer = PLAYERS.X;
            updateStatus();

            for (let i = 0; i < TOTAL_CELLS; i++) {
                const cell = document.createElement('div');
                cell.classList.add('cell');
                cell.setAttribute('data-index', i);
                cell.addEventListener('click', handleCellClick);
                gridElement.appendChild(cell);
            }
        }

        function updateStatus() {
            if (!gameActive) return;
            const pName = currentPlayer === PLAYERS.X ? "Blue (X)" : "Red (O)";
            const color = currentPlayer === PLAYERS.X ? "text-cyan-400" : "text-rose-400";
            statusDisplay.innerHTML = `Turn: <span class="${color} font-bold">${pName}</span> (Make a 2x2 square)`;
        }

        function handleCellClick(e) {
            const cell = e.target.closest('.cell');
            const index = parseInt(cell.getAttribute('data-index'));

            if (gameState[index] !== "" || !gameActive) return;

            // Update State
            gameState[index] = currentPlayer;
            cell.classList.add('taken');
            cell.innerHTML = currentPlayer === PLAYERS.X ? SVG_X : SVG_O;

            // Check Win
            if (checkWin()) {
                gameActive = false;
                const winnerName = currentPlayer === PLAYERS.X ? "Blue" : "Red";
                const color = currentPlayer === PLAYERS.X ? "text-cyan-400" : "text-rose-400";
                statusDisplay.innerHTML = `<span class="${color} font-bold text-xl">${winnerName} Wins!</span>`;
                return;
            }

            // Check Draw
            if (!gameState.includes("")) {
                gameActive = false;
                statusDisplay.innerHTML = `<span class="text-slate-200 font-bold">Draw!</span>`;
                return;
            }

            // Switch Player
            currentPlayer = currentPlayer === PLAYERS.X ? PLAYERS.O : PLAYERS.X;
            updateStatus();
        }

        function checkWin() {
            // Iterate through rows and cols up to GRID_SIZE - 1 to find top-left of a 2x2
            for (let row = 0; row < GRID_SIZE - 1; row++) {
                for (let col = 0; col < GRID_SIZE - 1; col++) {
                    const i = row * GRID_SIZE + col; // Top-Left index
                    const player = gameState[i];

                    if (player === "") continue;

                    // Calculate indices for the 2x2 block
                    const tr = i + 1;             // Top-Right
                    const bl = i + GRID_SIZE;     // Bottom-Left
                    const br = i + GRID_SIZE + 1; // Bottom-Right

                    // Check if all 4 cells belong to the same player
                    if (gameState[tr] === player && 
                        gameState[bl] === player && 
                        gameState[br] === player) {
                        
                        highlightWin([i, tr, bl, br]);
                        return true;
                    }
                }
            }
            return false;
        }

        function highlightWin(indices) {
            const cells = document.querySelectorAll('.cell');
            indices.forEach(index => {
                cells[index].classList.add('winning-cell');
            });
        }

        resetBtn.addEventListener('click', createBoard);

        // Start
        createBoard();

    </script>
</body>
</html>
